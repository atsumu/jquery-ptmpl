(function(a){function h(b){return b.replace(/\\/g,"\\\\").replace(/\r?\n\t*/g,"\\n").replace(/\'/g,"\\'").replace(/\"/g,'\\"')}function i(b){return Array.prototype.slice.call(b,0)}a.fn.ptmpl=function(b,e){a.isArray(b)||(b=[b]);var c=[],d=a.ptmplGetCompiled(this[0],e);a.each(b,function(){c.push(d(e,this))});var f=document.createElement("div");f.innerHTML=c.join("");return a(a.ptmplMakeArray(f.childNodes))};a.ptmpl=function(b,e,c){return a.fn.ptmpl.apply([{innerHTML:b}],[e,c])};a.ptmplStatic=function(b,
e,c){return a.fn.ptmpl.apply([{id:b.replace("#","")}],[e,c])};a.ptmplDefineTag=function(b){a.each(b,function(b,c){a.ptmplTagTable[b]=c})};a.ptmplUndefineTag=function(b){a.each(b,function(b,c){delete a.ptmplTagTable[c]})};a.ptmplCompile=function(b,e,c){e||(e={});var d=[];e.noDebugInfoOnExecute||d.push("try {\n");d.push("var _PTMPL_HTML = [];\n");d.push("with ($.ptmplScope(_PTMPL_ARG)) {\n");b.replace(/((?:a|[^a])*?)(?:\{\{((?:a|[^a])*?)\}\}|$)/g,function(b,c,f){c&&(b=a.ptmplTranslateHtmlToLiteral(c))&&
d.push('_PTMPL_HTML.push("',b,'");\n');f&&(f.match(/([^\s\(]+)((?:a|[^a])*)/),a.ptmplTagTable[RegExp.$1](d,RegExp.$2,e))});d.push("}\n");d.push('return _PTMPL_HTML.join("");');e.noDebugInfoOnExecute||(d.push("\n} catch (e) {\n"),d.push('throw new Error("RuntimeError in '+a.ptmplEscapeStringLiteral(c.id?c.id:c.text.slice(0,100))+', "+e.message);\n'),d.push("}"));b=d.join("");e.debug&&console.log("code:",b);try{var f=new Function("_PTMPL_OPTION","_PTMPL_ARG",b)}catch(g){throw e.noDebugInfoOnCompile||
(g.message+=" in "+(c.id?c.id:c.text.slice(0,100))),g;}return f};a.ptmplGetCompiled=function(b,e){var c=b.id,d=b.innerHTML;if(c){if(c in a.ptmplCache)return a.ptmplCache[c];if(d)return a.ptmplCache[c]=a.ptmplCompile(d,e,{id:"#"+c});d=document.getElementById(c).innerHTML;return a.ptmplCache[c]=a.ptmplCompile(d,e,{id:"#"+c})}return a.ptmplCompile(d,e,{text:d})};a.ptmplEscapeHtml=function(b){return(b?b.toString():""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,
"&#039;")};a.ptmplUnescapeHtml=function(b){return(b?b.toString():""+b).replace(/&#039;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")};a.ptmplEscapeUrl=encodeURIComponent;a.ptmplEscapeStringLiteral=h;a.ptmplTranslateHtmlToLiteral=h;a.ptmplMakeArray=a.makeArray||i;a.ptmplScope=function(b){function a(){}a.prototype=b;return new a};a.ptmplCache=a.ptmplCache||{};a.ptmplTagTable={};a.ptmplDefineTag({html:function(b,a){b.push("_PTMPL_HTML.push((",a,"));\n")},
"=":function(b,a){b.push("_PTMPL_HTML.push($.ptmplEscapeHtml((",a,")));\n")},"~":function(b,a){b.push("_PTMPL_HTML.push($.ptmplEscapeHtml($.ptmplEscapeUrl((",a,"))));\n")},$:function(b,a){b.push(a,"\n")},"!":function(){},"//":function(){}});var g;a.ptmplDefineTag({"if":function(b,a){b.push("if (",a,") {\n")},el:g=function(b,a){a?b.push("} else if (",a,") {\n"):b.push("} else {\n")},"else":g,"/if":function(b){b.push("}\n")}});a.ptmplDefineTag({tryif:function(b,a){b.push("if ((function () { try { return (",
a,"); } catch (e) {} })()) {\n")},catchelse:g=function(b,a){a?b.push("} else if ((function () { try { return (",a,"); } catch (e) {} })()) {\n"):b.push("} else {\n")},"/tryif":function(b){b.push("}\n")}});a.ptmplDefineTag({"for":function(b,a){b.push("for (",a,") {\n")},"/for":function(b){b.push("}\n")}});a.ptmplDefineTag({each:function(b,a){if(null==a.match(/\s*\((?:\s*(\w+)\s*(?:,\s*(\w+)\s*))\)\s+((?:a|[^a])+)/))throw"ptmpl syntax error: near {{each"+a+"}}";b.push("$.each((",RegExp.$3,"), function (",
RegExp.$1,",",RegExp.$2,") {\n")},"/each":function(b){b.push("});\n")},"continue":function(b){b.push("return true;\n")},"break":function(b){b.push("return false;\n")}});a.ptmplDefineTag({tmpl:function(b,a){if(null==a.match(/\s*\(((?:a|[^a])*?)\)\s+((?:a|[^a])+)/))throw"ptmpl syntax error: near {{tmpl"+a+"}}";var c=RegExp.$1||"{}",d=RegExp.$2,f=d.match(/^\s*['"]#(.+?)["']\s*$/)&&RegExp.$1;f?b.push('_PTMPL_HTML.push($.ptmplGetCompiled({ id:"',f,'" }, _PTMPL_OPTION)(_PTMPL_OPTION, (',c,")));\n"):b.push("_PTMPL_HTML.push($.ptmplGetCompiled($.find((",
d,"))[0], _PTMPL_OPTION)(_PTMPL_OPTION, (",c,")));\n")}});a.ptmplStripPluginTranslateFunctionStack=[];a.ptmplDefineTag({strip:function(){var b=a.ptmplTranslateHtmlToLiteral;a.ptmplStripPluginTranslateFunctionStack.push(b);a.ptmplTranslateHtmlToLiteral=function(a){return b(a.replace(/\r?\n\t*/g,""))}},"/strip":function(){a.ptmplTranslateHtmlToLiteral=a.ptmplStripPluginTranslateFunctionStack.pop()}})})(window.jQuery||window.Zepto);
