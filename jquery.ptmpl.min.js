(function(b){function h(a){return a.replace(/\\/g,"\\\\").replace(/\r?\n\t*/g,"\\n").replace(/\'/g,"\\'").replace(/\"/g,'\\"')}b.fn.ptmpl=function(a,c){b.isArray(a)||(a=[a]);var d="",e=this[0];b.each(a,function(){d+=b.ptmplGetCompiled(e,c)(c,this)});var f=document.createElement("div");f.innerHTML=d;return b(Array.prototype.slice.call(f.childNodes,0))};b.ptmpl=function(a,c,d){return b.fn.ptmpl.apply([{id:null,innerHTML:a}],[c,d])};b.ptmplDefineTag=function(a){b.each(a,function(a,d){b.ptmplTagTable[a]=
d})};b.ptmplUndefineTag=function(a){b.each(a,function(a,d){delete b.ptmplTagTable[d]})};b.ptmplCompile=function(a,c,d){c||(c={});var e=[];c.noDebugInfo||e.push("try {");e.push("var _PTMPL_HTML = [];");e.push("with ($.ptmplScope(_PTMPL_ARG)) {");a.replace(/((?:a|[^a])*?)(?:\{\{((?:a|[^a])*?)\}\}|$)/g,function(a,d,f){d&&(a=b.ptmplTranslateHtmlToLiteral(d))&&e.push('_PTMPL_HTML.push("',a,'");');f&&(f.match(/([^\s\(]+)((?:a|[^a])*)/),b.ptmplTagTable[RegExp.$1](e,RegExp.$2,c))});e.push("}");e.push('return _PTMPL_HTML.join("");');
c.noDebugInfo||(e.push("} catch (e) {"),e.push('throw new Error("RuntimeError in '+b.ptmplEscapeStringLiteral(d.id?d.id:d.text.slice(0,100))+', "+e.message);'),e.push("}"));a=e.join("");c.debug&&console.log("code:",a);try{var f=new Function("_PTMPL_OPTION","_PTMPL_ARG",a)}catch(g){throw c.noDebugInfo||(g.message+=" in "+(d.id?d.id:d.text.slice(0,100))),g;}return f};b.ptmplGetCompiled=function(a,c){var d=a.id,e=a.innerHTML;if(d){if(d in b.ptmplCache)return b.ptmplCache[d];if(e)return b.ptmplCache[d]=
b.ptmplCompile(e,c,{id:"#"+d});e=document.getElementById(d).innerHTML;return b.ptmplCache[d]=b.ptmplCompile(e,c,{id:"#"+d})}return b.ptmplCompile(e,c,{text:e})};b.ptmplEscapeHtml=function(a){return(a?a.toString():""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#039;")};b.ptmplUnescapeHtml=function(a){return(a?a.toString():""+a).replace(/&#039;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")};
b.ptmplEscapeUrl=encodeURIComponent;b.ptmplEscapeStringLiteral=h;b.ptmplTranslateHtmlToLiteral=h;b.ptmplScope=function(a){function c(){}c.prototype=a;return new c};b.ptmplCache={};b.ptmplTagTable={};b.ptmplDefineTag({html:function(a,c){a.push("_PTMPL_HTML.push((",c,"));")},"=":function(a,c){a.push("_PTMPL_HTML.push($.ptmplEscapeHtml((",c,")));")},"~":function(a,c){a.push("_PTMPL_HTML.push($.ptmplEscapeUrl((",c,")));")},$:function(a,c){a.push(c)},"!":function(){},"//":function(){}});var g;b.ptmplDefineTag({"if":function(a,
c){a.push("if (",c,") {")},el:g=function(a,c){c?a.push("} else if (",c,") {"):a.push("} else {")},"else":g,"/if":function(a){a.push("}")}});b.ptmplDefineTag({tryif:function(a,c){a.push("if ((function () { try { return (",c,"); } catch (e) {} })()) {")},catchelse:g=function(a,c){c?a.push("} else if ((function () { try { return (",c,"); } catch (e) {} })()) {"):a.push("} else {")},"/tryif":function(a){a.push("}")}});b.ptmplDefineTag({"for":function(a,c){a.push("for (",c,") {")},"/for":function(a){a.push("}")}});
b.ptmplDefineTag({each:function(a,c){if(null==c.match(/\s*\((?:\s*(\w+)\s*(?:,\s*(\w+)\s*))\)\s+((?:a|[^a])+)/))throw"ptmpl syntax error: near {{each"+c+"}}";a.push("$.each((",RegExp.$3,"), function (",RegExp.$1,",",RegExp.$2,") {")},"/each":function(a){a.push("});")},"continue":function(a){a.push("return true;")},"break":function(a){a.push("return false;")}});b.ptmplDefineTag({tmpl:function(a,c){if(null==c.match(/\s*\(((?:a|[^a])*?)\)\s+((?:a|[^a])+)/))throw"ptmpl syntax error: near {{tmpl"+c+"}}";
var b=RegExp.$1||"{}",e=RegExp.$2,f=e.match(/^\s*['"]#(.+?)["']\s*$/)&&RegExp.$1;f?a.push('_PTMPL_HTML.push($.ptmplGetCompiled({ id:"',f,'" }, _PTMPL_OPTION)(_PTMPL_OPTION, (',b,")));"):a.push("_PTMPL_HTML.push($.ptmplGetCompiled($.find((",e,"))[0], _PTMPL_OPTION)(_PTMPL_OPTION, (",b,")));")}});b.ptmplStripPluginTranslateFunctionStack=[];b.ptmplDefineTag({strip:function(){var a=b.ptmplTranslateHtmlToLiteral;b.ptmplStripPluginTranslateFunctionStack.push(a);b.ptmplTranslateHtmlToLiteral=function(b){return a(b.replace(/\r?\n\t*/g,
""))}},"/strip":function(){b.ptmplTranslateHtmlToLiteral=b.ptmplStripPluginTranslateFunctionStack.pop()}})})(window.jQuery||window.Zepto);
