(function(b){function h(a){return a.replace(/\\/g,"\\\\").replace(/\r?\n\t*/g,"\\n").replace(/\'/g,"\\'").replace(/\"/g,'\\"')}b.fn.ptmpl=function(a,c){b.isArray(a)||(a=[a]);var e=[],d=this[0];b.each(a,function(){e.push(b.ptmplGetCompiled(d,c)(c,this))});var f=document.createElement("div");f.innerHTML=e.join("");return b(i(f.childNodes))};b.ptmpl=function(a,c,e){return b.fn.ptmpl.apply([{id:null,innerHTML:a}],[c,e])};b.ptmplDefineTag=function(a){b.each(a,function(a,e){b.ptmplTagTable[a]=e})};b.ptmplUndefineTag=
function(a){b.each(a,function(a,e){delete b.ptmplTagTable[e]})};b.ptmplCompile=function(a,c,e){c||(c={});var d=[];c.noDebugInfo||d.push("try {");d.push("var _PTMPL_HTML = [];");d.push("with ($.ptmplScope(_PTMPL_ARG)) {");a.replace(/((?:a|[^a])*?)(?:\{\{((?:a|[^a])*?)\}\}|$)/g,function(a,e,f){e&&(a=b.ptmplTranslateHtmlToLiteral(e))&&d.push('_PTMPL_HTML.push("',a,'");');f&&(f.match(/([^\s\(]+)((?:a|[^a])*)/),b.ptmplTagTable[RegExp.$1](d,RegExp.$2,c))});d.push("}");d.push('return _PTMPL_HTML.join("");');
c.noDebugInfo||(d.push("} catch (e) {"),d.push('throw new Error("RuntimeError in '+b.ptmplEscapeStringLiteral(e.id?e.id:e.text.slice(0,100))+', "+e.message);'),d.push("}"));a=d.join("");c.debug&&console.log("code:",a);try{var f=new Function("_PTMPL_OPTION","_PTMPL_ARG",a)}catch(g){throw c.noDebugInfo||(g.message+=" in "+(e.id?e.id:e.text.slice(0,100))),g;}return f};b.ptmplGetCompiled=function(a,c){var e=a.id,d=a.innerHTML;if(e){if(e in b.ptmplCache)return b.ptmplCache[e];if(d)return b.ptmplCache[e]=
b.ptmplCompile(d,c,{id:"#"+e});d=document.getElementById(e).innerHTML;return b.ptmplCache[e]=b.ptmplCompile(d,c,{id:"#"+e})}return b.ptmplCompile(d,c,{text:d})};b.ptmplEscapeHtml=function(a){return(a?a.toString():""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#039;")};b.ptmplUnescapeHtml=function(a){return(a?a.toString():""+a).replace(/&#039;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")};
b.ptmplEscapeUrl=encodeURIComponent;b.ptmplEscapeStringLiteral=h;b.ptmplTranslateHtmlToLiteral=h;b.ptmplScope=function(a){function c(){}c.prototype=a;return new c};b.ptmplCache={};b.ptmplTagTable={};var k=Object.prototype.toString,i=function(a,c){a=Array.prototype.slice.call(a,0);return c?(c.push.apply(c,a),c):a};try{var j=Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(l){i=function(a,c){var b=0,d=c||[];if("[object Array]"===k.call(a))Array.prototype.push.apply(d,
a);else if("number"===typeof a.length)for(var f=a.length;b<f;b++)d.push(a[b]);else for(;a[b];b++)d.push(a[b]);return d}}finally{j&&(j=null)}b.ptmplDefineTag({html:function(a,c){a.push("_PTMPL_HTML.push((",c,"));")},"=":function(a,c){a.push("_PTMPL_HTML.push($.ptmplEscapeHtml((",c,")));")},"~":function(a,c){a.push("_PTMPL_HTML.push($.ptmplEscapeUrl((",c,")));")},$:function(a,c){a.push(c)},"!":function(){},"//":function(){}});var g;b.ptmplDefineTag({"if":function(a,c){a.push("if (",c,") {")},el:g=function(a,
c){c?a.push("} else if (",c,") {"):a.push("} else {")},"else":g,"/if":function(a){a.push("}")}});b.ptmplDefineTag({tryif:function(a,c){a.push("if ((function () { try { return (",c,"); } catch (e) {} })()) {")},catchelse:g=function(a,c){c?a.push("} else if ((function () { try { return (",c,"); } catch (e) {} })()) {"):a.push("} else {")},"/tryif":function(a){a.push("}")}});b.ptmplDefineTag({"for":function(a,c){a.push("for (",c,") {")},"/for":function(a){a.push("}")}});b.ptmplDefineTag({each:function(a,
c){if(null==c.match(/\s*\((?:\s*(\w+)\s*(?:,\s*(\w+)\s*))\)\s+((?:a|[^a])+)/))throw"ptmpl syntax error: near {{each"+c+"}}";a.push("$.each((",RegExp.$3,"), function (",RegExp.$1,",",RegExp.$2,") {")},"/each":function(a){a.push("});")},"continue":function(a){a.push("return true;")},"break":function(a){a.push("return false;")}});b.ptmplDefineTag({tmpl:function(a,c){if(null==c.match(/\s*\(((?:a|[^a])*?)\)\s+((?:a|[^a])+)/))throw"ptmpl syntax error: near {{tmpl"+c+"}}";var b=RegExp.$1||"{}",d=RegExp.$2,
f=d.match(/^\s*['"]#(.+?)["']\s*$/)&&RegExp.$1;f?a.push('_PTMPL_HTML.push($.ptmplGetCompiled({ id:"',f,'" }, _PTMPL_OPTION)(_PTMPL_OPTION, (',b,")));"):a.push("_PTMPL_HTML.push($.ptmplGetCompiled($.find((",d,"))[0], _PTMPL_OPTION)(_PTMPL_OPTION, (",b,")));")}});b.ptmplStripPluginTranslateFunctionStack=[];b.ptmplDefineTag({strip:function(){var a=b.ptmplTranslateHtmlToLiteral;b.ptmplStripPluginTranslateFunctionStack.push(a);b.ptmplTranslateHtmlToLiteral=function(b){return a(b.replace(/\r?\n\t*/g,""))}},
"/strip":function(){b.ptmplTranslateHtmlToLiteral=b.ptmplStripPluginTranslateFunctionStack.pop()}})})(window.jQuery||window.Zepto);
